apiVersion: v1
kind: Template
parameters:
  - name: IMAGE
    value: docker.io/maestroperf/maestro-sender:1.3.0
  - name: REPLICAS
    value: "1"
  - name: MAESTRO_BROKER
    required: true
objects:
  - apiVersion: apps/v1
    kind: Deployment
    metadata:
      name: maestro-sender
    spec:
      replicas: ${{REPLICAS}}
      selector:
        matchLabels:
          component: sender
          app: maestro
      template:
        metadata:
          labels:
            component: sender
            app: maestro
        spec:
          containers:
            - name: sender
              image: ${IMAGE}
              env:
                - name: MAESTRO_BROKER
                  value: ${MAESTRO_BROKER}
              volumeMounts:
                - mountPath: /maestro/sender/logs
                  name: logging-volume
          volumes:
            - name: logging-volume
              emptyDir: {}
